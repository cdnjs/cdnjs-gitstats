function sortables_init(){if(document.getElementsByTagName)for(tbls=document.getElementsByTagName("table"),ti=0;ti<tbls.length;ti++)thisTbl=tbls[ti],-1!=(" "+thisTbl.className+" ").indexOf("sortable")&&thisTbl.id&&ts_makeSortable(thisTbl)}function ts_makeSortable(e){if(e.rows&&e.rows.length>0)if(e.tHead&&e.tHead.rows.length>0){var t=e.tHead.rows[e.tHead.rows.length-1];thead=!0}else var t=e.rows[0];if(t){for(var r=0;r<t.cells.length;r++){var a=t.cells[r],s=ts_getInnerText(a);"unsortable"!=a.className&&-1==a.className.indexOf("unsortable")&&(a.innerHTML='<a href="#" class="sortheader" onclick="ts_resortTable(this, '+r+');return false;">'+s+'<span class="sortarrow">&nbsp;&nbsp;<img src="'+image_path+image_none+'" alt="&darr;"/></span></a>')}alternate_row_colors&&alternate(e)}}function ts_getInnerText(e){if("string"==typeof e)return e;if("undefined"==typeof e)return e;if(e.innerText)return e.innerText;for(var t="",r=e.childNodes,a=r.length,s=0;a>s;s++)switch(r[s].nodeType){case 1:t+=ts_getInnerText(r[s]);break;case 3:t+=r[s].nodeValue}return t}function ts_resortTable(e,t){for(var r,a=0;a<e.childNodes.length;a++)e.childNodes[a].tagName&&"span"==e.childNodes[a].tagName.toLowerCase()&&(r=e.childNodes[a]);var s=(ts_getInnerText(r),e.parentNode),n=t||s.cellIndex,o=getParent(s,"TABLE");if(!(o.rows.length<=1)){for(var d="",l=1;""==d&&l<o.tBodies[0].rows.length;){var d=ts_getInnerText(o.tBodies[0].rows[l].cells[n]);d=trim(d),"<!--"!=d.substr(0,4)&&0!=d.length||(d=""),l++}if(""!=d){sortfn=ts_sort_caseinsensitive,d.match(/^\d\d[\/\.-][a-zA-z][a-zA-Z][a-zA-Z][\/\.-]\d\d\d\d$/)&&(sortfn=ts_sort_date),d.match(/^\d\d[\/\.-]\d\d[\/\.-]\d\d\d{2}?$/)&&(sortfn=ts_sort_date),d.match(/^-?[�$�ۢ�]\d/)&&(sortfn=ts_sort_numeric),d.match(/^-?(\d+[,\.]?)+(E[-+][\d]+)?%?( \(.*\))?$/)&&(sortfn=ts_sort_numeric),SORT_COLUMN_INDEX=n;var i=new Array,c=new Array;for(k=0;k<o.tBodies.length;k++)for(l=0;l<o.tBodies[k].rows[0].length;l++)i[l]=o.tBodies[k].rows[0][l];for(k=0;k<o.tBodies.length;k++)if(thead)for(j=0;j<o.tBodies[k].rows.length;j++)c[j]=o.tBodies[k].rows[j];else for(j=1;j<o.tBodies[k].rows.length;j++)c[j-1]=o.tBodies[k].rows[j];for(c.sort(sortfn),"down"==r.getAttribute("sortdir")?(ARROW='&nbsp;&nbsp;<img src="'+image_path+image_down+'" alt="&darr;"/>',c.reverse(),r.setAttribute("sortdir","up")):(ARROW='&nbsp;&nbsp;<img src="'+image_path+image_up+'" alt="&uarr;"/>',r.setAttribute("sortdir","down")),l=0;l<c.length;l++)(!c[l].className||c[l].className&&-1==c[l].className.indexOf("sortbottom"))&&o.tBodies[0].appendChild(c[l]);for(l=0;l<c.length;l++)c[l].className&&-1!=c[l].className.indexOf("sortbottom")&&o.tBodies[0].appendChild(c[l]);for(var _=document.getElementsByTagName("span"),a=0;a<_.length;a++)"sortarrow"==_[a].className&&getParent(_[a],"table")==getParent(e,"table")&&(_[a].innerHTML='&nbsp;&nbsp;<img src="'+image_path+image_none+'" alt="&darr;"/>');r.innerHTML=ARROW,alternate(o)}}}function getParent(e,t){return null==e?null:1==e.nodeType&&e.tagName.toLowerCase()==t.toLowerCase()?e:getParent(e.parentNode,t)}function sort_date(e){if(dt="00000000",11==e.length){switch(mtstr=e.substr(3,3),mtstr=mtstr.toLowerCase(),mtstr){case"jan":var t="01";break;case"feb":var t="02";break;case"mar":var t="03";break;case"apr":var t="04";break;case"may":var t="05";break;case"jun":var t="06";break;case"jul":var t="07";break;case"aug":var t="08";break;case"sep":var t="09";break;case"oct":var t="10";break;case"nov":var t="11";break;case"dec":var t="12"}return dt=e.substr(7,4)+t+e.substr(0,2),dt}return 10==e.length?0==europeandate?(dt=e.substr(6,4)+e.substr(0,2)+e.substr(3,2),dt):(dt=e.substr(6,4)+e.substr(3,2)+e.substr(0,2),dt):8==e.length?(yr=e.substr(6,2),parseInt(yr)<50?yr="20"+yr:yr="19"+yr,1==europeandate?(dt=yr+e.substr(3,2)+e.substr(0,2),dt):(dt=yr+e.substr(0,2)+e.substr(3,2),dt)):dt}function ts_sort_date(e,t){return dt1=sort_date(ts_getInnerText(e.cells[SORT_COLUMN_INDEX])),dt2=sort_date(ts_getInnerText(t.cells[SORT_COLUMN_INDEX])),dt1==dt2?0:dt1<dt2?-1:1}function ts_sort_numeric(e,t){var r=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]);r=clean_num(r);var a=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]);return a=clean_num(a),compare_numeric(r,a)}function compare_numeric(e,t){var e=parseFloat(e);e=isNaN(e)?0:e;var t=parseFloat(t);return t=isNaN(t)?0:t,e-t}function ts_sort_caseinsensitive(e,t){return aa=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]).toLowerCase(),bb=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]).toLowerCase(),aa==bb?0:aa<bb?-1:1}function ts_sort_default(e,t){return aa=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]),bb=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]),aa==bb?0:aa<bb?-1:1}function addEvent(e,t,r,a){if(e.addEventListener)return e.addEventListener(t,r,a),!0;if(e.attachEvent){var s=e.attachEvent("on"+t,r);return s}alert("Handler could not be removed")}function clean_num(e){return e=e.replace(new RegExp(/[^-?0-9.]/g),"")}function trim(e){return e.replace(/^\s+|\s+$/g,"")}function alternate(e){for(var t=e.getElementsByTagName("tbody"),r=0;r<t.length;r++)for(var a=t[r].getElementsByTagName("tr"),s=0;s<a.length;s++)s%2==0?-1!=a[s].className.indexOf("odd")?a[s].className=a[s].className.replace("odd","even"):-1==a[s].className.indexOf("even")&&(a[s].className+=" even"):-1!=a[s].className.indexOf("even")?a[s].className=a[s].className.replace("even","odd"):-1==a[s].className.indexOf("odd")&&(a[s].className+=" odd")}var image_path="",image_up="arrow-up.gif",image_down="arrow-down.gif",image_none="arrow-none.gif",europeandate=!0,alternate_row_colors=!0;addEvent(window,"load",sortables_init);var SORT_COLUMN_INDEX,thead=!1;